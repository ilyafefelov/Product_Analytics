# Домашнє завдання 7 — Довірчі інтервали та A/B-тест конверсій

Цей каталог містить матеріали для ДЗ за темою аналізу воронки: оцінка довірчого інтервалу для конверсії та статистичне порівняння конверсій двох груп у A/B‑тесті.

Основний результат для здачі — Excel‑файл:

- `Fefelov_PA_assignment_7.xls`
  - Лист `Task1`: розрахунок 95% довірчого інтервалу (ДІ) для одиночної пропорції (конверсії).
  - Лист `Task2_Overview`: зведені метрики A і B (p̂, n, кількість успіхів).
  - Лист `Task2_Stats`: статистики двовибіркового z‑тесту пропорцій і 95% ДІ різниці.
  - Лист `README`: коротка методологія.

Скрипт, який генерує Excel‑файл: `generate_assignment_7_xls.py`.

---

## Що ми рахуємо

### 1) Довірчий інтервал для конверсії (одна пропорція)

- Дані: p̂ = 0.45 (45%), n = 8000.
- Формула (Wald CI, 95%):
  
  p̂ ± 1.96 · sqrt( p̂ · (1 − p̂) / n )

- Результат (обчислений):
  - SE = 0.005562
  - Margin = 0.010902
  - 95% ДІ: 0.4391 … 0.4609 → 43.91% … 46.09%

- Інтерпретація: якби ми багато разів повторювали вибірку і кожного разу будували 95% ДІ, то ≈95% таких інтервалів накривали б істинне значення конверсії. Це не «ймовірність для параметра», а властивість процедури оцінювання.

- Зауваження: Wald‑інтервал добре працює за великих n і коли p̂ не надто близька до 0 або 1. За потреби можна використовувати Wilson, Agresti–Coull або баєсівський підхід (Beta‑розподіл) — особливо для малих вибірок або крайніх p̂.

### 2) Порівняння двох конверсій (дві пропорції, A/B)

- Дані:
  - Група A: p̂_A = 0.55, n_A = 12000
  - Група B: p̂_B = 0.58, n_B = 12000

- Гіпотези:
  - H0: p_A = p_B
  - H1: p_A ≠ p_B (двобічний тест)

- Z‑тест для двох пропорцій (під H0 використовуємо pooled‑оцінку):
  - p_pool = (x_A + x_B) / (n_A + n_B)
  - SE_pooled = sqrt( p_pool · (1 − p_pool) · (1/n_A + 1/n_B) )
  - z = (p̂_B − p̂_A) / SE_pooled
  - p‑value — двобічне, за стандартним нормальним розподілом.

- 95% ДІ для різниці (B − A) рахується з unpooled SE:
  - SE_unpooled = sqrt( p̂_A(1 − p̂_A)/n_A + p̂_B(1 − p̂_B)/n_B )
  - CI: (p̂_B − p̂_A) ± 1.96 · SE_unpooled

- Результати (обчислені):
  - Різниця (B − A) = 0.0300 → 3.00 в.п.
  - z = 4.6874
  - p‑value = 2.77e‑06 (статистично значущо на 5% рівні)
  - 95% ДІ різниці: 0.0175 … 0.0425 → 1.75 … 4.25 в.п.

- Інтерпретація: наявні статистично значущі докази, що конверсія групи B вища за конверсію групи A; очікувана перевага — приблизно на 1.75–4.25 відсоткових пункти.

---

## Як відтлумачити результати бізнесом

- ДЗ №1: «Справжня» конверсія між етапами воронки з великою ймовірністю лежить між 43.91% і 46.09%. Це дає відчуття точності оцінки і корисне для планування та моніторингу трендів.
- ДЗ №2: A/B показав покращення в B на ~3 в.п., статистично значуще. Це підстава рекомендувати варіант B до розгортання, за умови відсутності негативних ефектів на інші метрики (ARPU, retention тощо).

---

## Припущення й обмеження

- Незалежні спостереження всередині та між групами.
- Однакове визначення події «конверсії» для A і B.
- Послідовні періоди/аудиторії: відсутні системні зміни середовища експерименту.
- Для кількох одночасних експериментів потрібні корекції за множинні порівняння.

---

## Як перегенерувати Excel‑файл (опціонально)

Потрібні Python 3.10+ та бібліотеки `pandas`, `xlwt`.

- Скрипт: `goit_pa_hm_7/generate_assignment_7_xls.py`
- Вихід: `goit_pa_hm_7/Fefelov_PA_assignment_7.xls`

> PowerShell (опціонально):

```powershell
# Перейти в каталог ДЗ
Push-Location "D:\School\GoIT\Courses\Product_Analytics\goit_pa_hm_7"

# Запустити генерацію (використовуйте ваш python, якщо інший шлях)
"C:/Program Files/Python313/python.exe" .\generate_assignment_7_xls.py

# Повернутися назад
Pop-Location
```

Якщо потрібно інше прізвище у назві файлу — дайте знати, швидко перегенеруємо.

---

## Глосарій термінів і швидкі пояснення

- Конверсія (conversion rate): частка користувачів, що виконали цільову подію. Формально — це пропорція успіхів.
- Пропорція p̂ (p-hat): вибіркова оцінка конверсії, p̂ = x/n, де x — кількість «успіхів», n — розмір вибірки.
- Кількість успіхів (x): скільки з n користувачів конвертувалися. Зручно: x = round(p̂·n).
- Стандартна похибка (SE): оцінка мінливості p̂.
  - Для однієї пропорції: SE = sqrt(p̂·(1−p̂)/n)
  - Для різниці пропорцій (unpooled): SE = sqrt(p̂_A(1−p̂_A)/n_A + p̂_B(1−p̂_B)/n_B)
  - Для z‑тесту під H0 (pooled): SE_pooled = sqrt(p_pool·(1−p_pool)·(1/n_A + 1/n_B))
- Довірчий інтервал (CI): інтервальна оцінка невідомого параметра. Для Wald‑CI (95%): p̂ ± 1.96·SE.
  - 95% означає: якщо багато разів повторювати процедуру, ≈95% побудованих інтервалів накриватимуть істинне значення.
- Z‑статистика (z‑value): стандартизований показник відхилення оцінки від гіпотетичного значення.
  - Для A/B: z = (p̂_B − p̂_A) / SE_pooled під H0: p_A = p_B.
- p‑value: імовірність спостерігати значення статистики «не менш екстремальне», ніж фактичне, якщо нульова гіпотеза H0 істинна.
  - Малий p‑value (< 0.05) свідчить проти H0 (є статистична значущість), але НЕ є «ймовірністю, що H0 істинна/хибна».
- Pooled‑пропорція (p_pool): об’єднана оцінка частки під H0: p_pool = (x_A + x_B) / (n_A + n_B).
- Відсоткові пункти (в.п.): одиниці виміру для різниць у відсотках. Напр., 55% → 58% — це +3 в.п.
- Статистична vs практична значущість: мале p‑value вказує на статистичну різницю; водночас треба оцінювати «розмір ефекту» (напр., у в.п.) й бізнес‑вплив.
- Помилка I роду (α): ймовірність відхилити H0, коли вона істинна (хибна тривога). Типово α = 0.05.
- Помилка II роду (β): ймовірність не відхилити H0, коли вона хибна (пропустити ефект). Потужність = 1−β.

Швидка пам’ятка інтерпретацій:

- ДІ: «де може лежати істинна конверсія» з обраним рівнем довіри.
- p‑value: «наскільки незвично такі або екстремальні дані за умови, що різниці немає». Чим менше — тим сильніші докази проти H0.
- z‑value: «скільки стандартних похибок між оцінками»; великі |z| → менші p‑value.

---

## Файли в каталозі

- `Fefelov_PA_assignment_7.xls` — фінальний файл для здачі (LMS + Google Drive).
- `generate_assignment_7_xls.py` — скрипт для відтворення підрахунків і формування .xls.
- `250415 PA_AS Lesson 07 code.ipynb` — практичні приклади з лекції (біноміальний, бета‑розподіл, survival‑аналіз).
- `250414 Theme07.pptx.txt` — конспект із теорією теми.
